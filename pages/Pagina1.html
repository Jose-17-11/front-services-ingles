<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TecgLish - Login</title>
    <style>
        @font-face {
            font-family: 'Pixelify Sans';
            src: url('https://fonts.cdnfonts.com/s/23084/PixelifySans.woff') format('woff');
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: #DDE3CC; /* Color de fondo */
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        .login-container {
            background-color: transparent; /* Fondo transparente */
            padding: 20px;
            text-align: center;
            width: 300px;
        }

        .title-container {
            background-color: #1B396B; /* Fondo azul para el título */
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        .title {
            font-size: 30px;
            color: white; /* Color blanco para el texto dentro del rectángulo azul */
            font-family: 'Pixelify Sans', monospace; /* Fuente Pixelify Sans */
        }

        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .form-group label {
            font-size: 12px;
            color: #333;
        }

        .show-password {
            cursor: pointer;
            font-size: 12px;
            color: #001d60; /* Color para el botón Mostrar/Ocultar */
        }

        .forgot-password {
            font-size: 12px;
            color: #555;
            margin-bottom: 20px;
            text-align: right;
        }

        .login-btn {
            background-color: #001d60; /* Color del botón azul oscuro */
            color: white;
            padding: 10px;
            border: none;
            width: 100%;
            border-radius: 5px;
            cursor: pointer;
        }

        .login-btn:hover {
            background-color: #002a80;
        }

        .no-account {
            font-size: 12px;
            color: #777;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="title-container">
            <div class="title">TecGlish</div>
        </div>
        <img class="logo" src="../assets/LogoTec.png" alt="Logo" style="width:100px; margin-bottom: 20px;"> <!-- Puedes agregar la imagen del logo aquí -->
        <form id="loginForm" method="post">
            <div class="form-group">
                <label for="email">Correo Institucional</label>
                <input type="email" id="email" placeholder="usuario@cuautla.tecnm.mx" required>
            </div>
            <div class="form-group">
                <label for="password">Contraseña</label>
                <input type="password" id="password" required>
                <span class="show-password" onclick="togglePassword()">MOSTRAR</span>
            </div>
            <div class="forgot-password">
                <a href="#">¿Olvidaste la contraseña?</a>
            </div>
            <button type="submit" class="login-btn">Entrar</button>
        </form>
        <div class="no-account">
            ¿Aún no tienes cuenta? Contacta a tu institución para obtener más información.
        </div>
    </div>

    <script>
        // Funcion para ocultar o mostrar la contraseña
        function togglePassword() {
            let passwordField = document.getElementById("password");
            let passwordToggle = document.querySelector(".show-password");
            if (passwordField.type === "password") {
                passwordField.type = "text";
                passwordToggle.textContent = "OCULTAR";
            } else {
                passwordField.type = "password";
                passwordToggle.textContent = "MOSTRAR";
            }
        }

        let form = document.getElementById("loginForm");
        form.addEventListener('submit', (e) => {
            let user = document.getElementById("email").value;
            let pass = document.getElementById("password").value;
            event.preventDefault();
            const data = {email: user, password: pass}
            const response = postData('http://localhost:3000/user',data)
            console.log(response);
            
        })
        async function postData(url, data) {
        // Opciones por defecto estan marcadas con un *
        const response = await fetch(url, {
            method: 'POST', // *GET, POST, PUT, DELETE, etc.
            mode: 'cors', // no-cors, *cors, same-origin
            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
            credentials: 'same-origin', // include, *same-origin, omit
            headers: {
            'Content-Type': 'application/json'
            // 'Content-Type': 'application/x-www-form-urlencoded',
            },
            redirect: 'follow', // manual, *follow, error
            referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url
            body: JSON.stringify(data) // body data type must match "Content-Type" header
        });
        if (response.ok) {
            const result = await response.json(); // Convierte a JSON la respuesta                 
            // Almacenar el token en localStorage
            if (result.token) {
                localStorage.setItem('authToken', result.token);
                console.log('Token almacenado en localStorage');
            } else {
                console.log("el token no se pudo almacenar: " + result.token);
                
            }
            window.location.href = "Pagina2.html";
            return result;
        } else {
            // Manejo del error si la respuesta no es exitosa
            console.error("Error en la petición:", response.status);
            alert("EL usuario o contraseña son incorrectos")
            return null;
        }
        }
    </script>
</body>
</html>

<!-- // Validación del correo institucional
            if (!email.endsWith("@cuautla.tecnm.mx")) {
                alert("Por favor ingresa un correo institucional válido (@cuautla.tecnm.mx).");
                return;
            } -->
